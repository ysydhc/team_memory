<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>team_memory â€” å›¢é˜Ÿç»éªŒåº“</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg-primary: #0a0e17;
  --bg-secondary: #111827;
  --bg-card: #1a2234;
  --bg-card-hover: #1f2a40;
  --bg-input: #0f1724;
  --border: #2a3650;
  --border-focus: #3b82f6;
  --text-primary: #e8ecf4;
  --text-secondary: #8899b4;
  --text-muted: #5b6b85;
  --accent: #3b82f6;
  --accent-hover: #2563eb;
  --accent-glow: rgba(59, 130, 246, 0.15);
  --green: #22c55e;
  --green-bg: rgba(34, 197, 94, 0.1);
  --red: #ef4444;
  --red-bg: rgba(239, 68, 68, 0.1);
  --yellow: #f59e0b;
  --yellow-bg: rgba(245, 158, 11, 0.1);
  --tag-bg: rgba(59, 130, 246, 0.12);
  --tag-text: #60a5fa;
  --font-sans: 'Noto Sans SC', -apple-system, sans-serif;
  --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
  --radius: 8px;
  --radius-lg: 12px;
  --shadow: 0 4px 24px rgba(0,0,0,0.3);
  --transition: 0.2s ease;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: var(--font-sans);
  background: var(--bg-primary);
  color: var(--text-primary);
  line-height: 1.6;
  min-height: 100vh;
}

/* ===== Scrollbar ===== */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

/* ===== Login Screen ===== */
#login-screen {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  background: radial-gradient(ellipse at 50% 0%, rgba(59,130,246,0.08) 0%, transparent 60%),
              var(--bg-primary);
}

.login-box {
  width: 400px;
  padding: 48px 40px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
}

.login-box .logo {
  font-family: var(--font-mono);
  font-size: 28px;
  font-weight: 600;
  color: var(--accent);
  margin-bottom: 6px;
  letter-spacing: -0.5px;
}

.login-box .subtitle {
  font-size: 14px;
  color: var(--text-muted);
  margin-bottom: 36px;
}

.login-box .error-msg {
  padding: 10px 14px;
  background: var(--red-bg);
  border: 1px solid rgba(239,68,68,0.2);
  border-radius: var(--radius);
  color: var(--red);
  font-size: 13px;
  margin-bottom: 16px;
  display: none;
}

/* ===== Form Elements ===== */
.form-group { margin-bottom: 20px; }
.form-group label {
  display: block;
  font-size: 13px;
  font-weight: 500;
  color: var(--text-secondary);
  margin-bottom: 8px;
}

input, textarea, select {
  width: 100%;
  padding: 10px 14px;
  background: var(--bg-input);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-family: var(--font-sans);
  font-size: 14px;
  transition: border-color var(--transition);
  outline: none;
}

input:focus, textarea:focus, select:focus {
  border-color: var(--border-focus);
  box-shadow: 0 0 0 3px var(--accent-glow);
}

input::placeholder, textarea::placeholder {
  color: var(--text-muted);
}

textarea {
  min-height: 100px;
  resize: vertical;
}

.btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 20px;
  border: none;
  border-radius: var(--radius);
  font-family: var(--font-sans);
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all var(--transition);
}

.btn-primary {
  background: var(--accent);
  color: #fff;
}
.btn-primary:hover { background: var(--accent-hover); }

.btn-secondary {
  background: transparent;
  color: var(--text-secondary);
  border: 1px solid var(--border);
}
.btn-secondary:hover {
  background: var(--bg-card-hover);
  color: var(--text-primary);
}

.btn-danger {
  background: var(--red-bg);
  color: var(--red);
  border: 1px solid rgba(239,68,68,0.2);
}
.btn-danger:hover { background: rgba(239,68,68,0.2); }

.btn-sm {
  padding: 6px 14px;
  font-size: 13px;
}

.btn-full { width: 100%; justify-content: center; }

/* ===== Layout ===== */
#app-screen { display: none; min-height: 100vh; }

.topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 32px;
  height: 56px;
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  z-index: 100;
}

.topbar-left {
  display: flex;
  align-items: center;
  gap: 24px;
}

.topbar-logo {
  font-family: var(--font-mono);
  font-size: 16px;
  font-weight: 600;
  color: var(--accent);
  letter-spacing: -0.3px;
}

.topbar-nav {
  display: flex;
  gap: 4px;
}

.topbar-nav a {
  padding: 6px 14px;
  font-size: 13px;
  font-weight: 500;
  color: var(--text-muted);
  text-decoration: none;
  border-radius: var(--radius);
  transition: all var(--transition);
  cursor: pointer;
}

.topbar-nav a:hover { color: var(--text-secondary); background: var(--bg-card); }
.topbar-nav a.active { color: var(--text-primary); background: var(--bg-card); }

.topbar-right {
  display: flex;
  align-items: center;
  gap: 16px;
}

.user-badge {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px 12px 4px 4px;
  background: var(--bg-card);
  border-radius: 20px;
  font-size: 13px;
  color: var(--text-secondary);
}

.user-avatar {
  width: 28px;
  height: 28px;
  background: var(--accent);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 600;
  color: #fff;
}

.logout-btn {
  font-size: 13px;
  color: var(--text-muted);
  cursor: pointer;
  background: none;
  border: none;
  font-family: var(--font-sans);
}
.logout-btn:hover { color: var(--red); }

.main-content {
  max-width: 1200px;
  margin: 0 auto;
  padding: 32px;
}

/* ===== Dashboard Stats ===== */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin-bottom: 32px;
}

.stat-card {
  padding: 24px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  transition: border-color var(--transition);
}
.stat-card:hover { border-color: var(--accent); }

.stat-value {
  font-size: 32px;
  font-weight: 700;
  font-family: var(--font-mono);
  color: var(--text-primary);
  margin-bottom: 4px;
}

.stat-label {
  font-size: 13px;
  color: var(--text-muted);
}

/* ===== Search Bar ===== */
.search-bar {
  display: flex;
  gap: 12px;
  margin-bottom: 12px;
}

.search-bar input {
  flex: 1;
}

.search-advanced-toggle {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  font-size: 13px;
  color: var(--text-muted);
  cursor: pointer;
  background: var(--bg-input);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  margin-bottom: 12px;
  transition: background var(--transition);
}
.search-advanced-toggle:hover { background: var(--bg-card); color: var(--text-secondary); }
.search-advanced-toggle .toggle-arrow { transition: transform 0.2s; }
.search-advanced-toggle.expanded .toggle-arrow { transform: rotate(90deg); }

.search-advanced { margin-bottom: 24px; }
.search-params-row {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  padding: 16px;
  background: var(--bg-input);
  border: 1px solid var(--border);
  border-radius: var(--radius);
}

/* ===== Group Child Form ===== */
.group-child-block {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  margin-bottom: 12px;
  overflow: hidden;
}
.group-child-block .child-block-header {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  background: var(--bg-input);
  cursor: pointer;
  transition: background var(--transition);
}
.group-child-block .child-block-header:hover { background: var(--bg-card-hover); }
.group-child-block .child-block-header .child-num {
  background: var(--accent);
  color: #fff;
  width: 22px;
  height: 22px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  font-weight: 600;
  flex-shrink: 0;
}
.group-child-block .child-block-header .child-block-title-input {
  flex: 1;
  padding: 6px 10px;
  font-size: 13px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--bg-primary);
  color: var(--text-primary);
}
.group-child-block .child-block-body {
  padding: 12px 14px;
  border-top: 1px solid var(--border);
}
.group-child-block.collapsed .child-block-body { display: none; }
.group-child-block .child-block-toggle { color: var(--text-muted); transition: transform 0.2s; }
.group-child-block.expanded .child-block-toggle { transform: rotate(90deg); }

/* ===== Tag Chips ===== */
.tag {
  display: inline-block;
  padding: 3px 10px;
  background: var(--tag-bg);
  color: var(--tag-text);
  font-size: 12px;
  font-weight: 500;
  font-family: var(--font-mono);
  border-radius: 4px;
  margin: 2px 4px 2px 0;
  cursor: pointer;
  transition: all var(--transition);
}
.tag:hover { background: rgba(59,130,246,0.2); }

.tags-bar {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-bottom: 24px;
  padding: 12px 16px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
}

.tags-bar .tag-label {
  font-size: 12px;
  color: var(--text-muted);
  margin-right: 8px;
  line-height: 24px;
}

/* ===== Experience List ===== */
.exp-list { display: flex; flex-direction: column; gap: 12px; }

.exp-card {
  padding: 20px 24px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  cursor: pointer;
  transition: all var(--transition);
}
.exp-card:hover {
  border-color: var(--accent);
  background: var(--bg-card-hover);
  transform: translateY(-1px);
  box-shadow: 0 8px 32px rgba(0,0,0,0.2);
}

.exp-card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 8px;
}

.exp-card-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
  flex: 1;
}

.exp-card-meta {
  display: flex;
  gap: 16px;
  align-items: center;
  font-size: 12px;
  color: var(--text-muted);
  flex-shrink: 0;
  margin-left: 16px;
}

.exp-card-desc {
  font-size: 14px;
  color: var(--text-secondary);
  margin-bottom: 12px;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.exp-card-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.exp-card-tags { display: flex; flex-wrap: wrap; gap: 4px; }

.similarity-badge {
  padding: 3px 10px;
  background: var(--green-bg);
  color: var(--green);
  font-size: 12px;
  font-weight: 600;
  font-family: var(--font-mono);
  border-radius: 4px;
}

.rating-badge {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: var(--yellow);
}

/* severity badges */
.severity-badge { font-size: 11px; font-weight: 600; padding: 2px 8px; border-radius: 4px; }
.severity-p0 { background: var(--red-bg); color: var(--red); }
.severity-p1 { background: rgba(249,115,22,0.15); color: #f97316; }
.severity-p2 { background: var(--yellow-bg); color: var(--yellow); }
.severity-p3 { background: rgba(59,130,246,0.15); color: var(--accent); }
.severity-p4 { background: rgba(107,114,128,0.2); color: #9ca3af; }

/* completeness bar */
.completeness-bar { height: 4px; background: var(--border); border-radius: 2px; overflow: hidden; margin-top: 4px; }
.completeness-bar-fill { height: 100%; background: var(--accent); border-radius: 2px; transition: width 0.2s; }

/* type icon in cards */
.type-icon { font-size: 14px; margin-right: 4px; }

/* collapsible section */
.detail-collapsible { cursor: pointer; padding: 8px 0; border-bottom: 1px solid var(--border); }
.detail-collapsible:hover { background: var(--bg-card-hover); }
.detail-collapsible .toggle-arrow { transition: transform 0.2s; display: inline-block; }
.detail-collapsible.expanded .toggle-arrow { transform: rotate(90deg); }

/* ===== Detail View ===== */
.detail-view {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  overflow: hidden;
}

.detail-header {
  padding: 32px;
  border-bottom: 1px solid var(--border);
}

.detail-header h1 {
  font-size: 24px;
  font-weight: 700;
  margin-bottom: 12px;
}

.detail-meta {
  display: flex;
  gap: 24px;
  font-size: 13px;
  color: var(--text-muted);
}

.detail-meta span {
  display: flex;
  align-items: center;
  gap: 6px;
}

.detail-body {
  padding: 32px;
}

.detail-section {
  margin-bottom: 28px;
}

.detail-section h3 {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 12px;
}

.detail-section .content {
  font-size: 15px;
  color: var(--text-secondary);
  white-space: pre-wrap;
  line-height: 1.7;
}

.code-block {
  background: var(--bg-primary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px 20px;
  font-family: var(--font-mono);
  font-size: 13px;
  color: var(--text-secondary);
  overflow-x: auto;
  white-space: pre;
  line-height: 1.6;
}

.detail-actions {
  padding: 24px 32px;
  border-top: 1px solid var(--border);
  display: flex;
  gap: 12px;
  align-items: center;
}

.back-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 20px;
  font-size: 13px;
  color: var(--text-muted);
  cursor: pointer;
  background: none;
  border: none;
  font-family: var(--font-sans);
  padding: 0;
}
.back-btn:hover { color: var(--accent); }

/* ===== Feedback Section ===== */
.feedback-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.feedback-item {
  padding: 14px 18px;
  background: var(--bg-input);
  border-radius: var(--radius);
  border: 1px solid var(--border);
}

.feedback-item .fb-header {
  display: flex;
  justify-content: space-between;
  margin-bottom: 6px;
  font-size: 13px;
}

.fb-helpful { color: var(--green); }
.fb-not-helpful { color: var(--red); }

.fb-stars { color: var(--yellow); font-size: 14px; letter-spacing: 1px; }

.children-badge {
  background: var(--accent-glow);
  color: var(--accent);
  padding: 2px 8px;
  border-radius: 10px;
  font-size: 12px;
  font-weight: 500;
}

.children-list { display: flex; flex-direction: column; gap: 8px; }
.child-item {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
}
.child-header {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  cursor: pointer;
  background: var(--bg-input);
  transition: background var(--transition);
}
.child-header:hover { background: var(--bg-card-hover); }
.child-idx {
  background: var(--accent);
  color: #fff;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 600;
  flex-shrink: 0;
}
.child-title { flex: 1; font-weight: 500; }
.child-toggle { color: var(--text-muted); transition: transform 0.2s; }
.child-item.expanded .child-toggle { transform: rotate(90deg); }
.child-body {
  display: none;
  padding: 12px 14px;
  border-top: 1px solid var(--border);
}
.child-item.expanded .child-body { display: block; }
.child-field { margin-bottom: 8px; font-size: 14px; color: var(--text-secondary); }
.child-field pre {
  background: var(--bg-input);
  padding: 10px;
  border-radius: var(--radius);
  overflow-x: auto;
  font-family: var(--font-mono);
  font-size: 13px;
  margin-top: 4px;
}

.star-rating { display: inline-flex; gap: 4px; direction: rtl; }
.star-rating input { display: none; }
.star-rating label {
  font-size: 28px;
  color: var(--border);
  cursor: pointer;
  transition: color 0.15s;
  user-select: none;
}
.star-rating label:hover,
.star-rating label:hover ~ label,
.star-rating input:checked ~ label {
  color: var(--yellow);
}

.feedback-item .fb-comment {
  font-size: 14px;
  color: var(--text-secondary);
}

/* ===== Settings Page ===== */
.settings-card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 28px;
  max-width: 720px;
}

.settings-card h2 {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 8px;
}

.settings-card .settings-desc {
  font-size: 13px;
  color: var(--text-muted);
  margin-bottom: 24px;
}

.settings-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}

.settings-grid .form-group {
  margin-bottom: 0;
}

.settings-grid .form-group.full-width {
  grid-column: 1 / -1;
}

.settings-grid label {
  display: block;
  font-size: 13px;
  font-weight: 500;
  color: var(--text-secondary);
  margin-bottom: 6px;
}

.settings-grid label .hint {
  font-weight: 400;
  color: var(--text-muted);
  margin-left: 4px;
}

.settings-actions {
  margin-top: 24px;
  display: flex;
  align-items: center;
  gap: 12px;
}

.settings-actions .save-status {
  font-size: 13px;
  color: var(--text-muted);
}

/* ===== Modal ===== */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  backdrop-filter: blur(4px);
}

.modal {
  width: 640px;
  max-height: 85vh;
  overflow-y: auto;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  box-shadow: 0 24px 64px rgba(0,0,0,0.5);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 24px 28px;
  border-bottom: 1px solid var(--border);
}

.modal-header h2 {
  font-size: 18px;
  font-weight: 600;
}

.modal-close {
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 20px;
  cursor: pointer;
  padding: 4px;
  line-height: 1;
}
.modal-close:hover { color: var(--text-primary); }

.modal-body { padding: 28px; }
.modal-footer {
  padding: 20px 28px;
  border-top: 1px solid var(--border);
  display: flex;
  justify-content: flex-end;
  gap: 12px;
}

/* ===== Pagination ===== */
.pagination {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  margin-top: 24px;
}

.pagination button {
  padding: 6px 14px;
  font-size: 13px;
}

.page-info {
  font-size: 13px;
  color: var(--text-muted);
  margin: 0 12px;
}

/* ===== Empty state ===== */
.empty-state {
  text-align: center;
  padding: 64px 32px;
  color: var(--text-muted);
}

.empty-state .icon { font-size: 48px; margin-bottom: 16px; opacity: 0.4; }
.empty-state h3 { font-size: 18px; color: var(--text-secondary); margin-bottom: 8px; }
.empty-state p { font-size: 14px; }

/* ===== Loading ===== */
.loading {
  display: flex;
  justify-content: center;
  padding: 48px;
}

.spinner {
  width: 32px;
  height: 32px;
  border: 3px solid var(--border);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin { to { transform: rotate(360deg); } }

/* ===== Toast ===== */
.toast-container {
  position: fixed;
  top: 72px;
  right: 32px;
  z-index: 2000;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.toast {
  padding: 12px 20px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  font-size: 14px;
  box-shadow: var(--shadow);
  animation: slideIn 0.3s ease;
  max-width: 400px;
}

.toast.success { border-left: 3px solid var(--green); color: var(--green); }
.toast.error { border-left: 3px solid var(--red); color: var(--red); }
.toast.info { border-left: 3px solid var(--accent); color: var(--accent); }

@keyframes slideIn {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

/* ===== Mode Tabs ===== */
.mode-tabs {
  display: flex;
  gap: 0;
  margin-bottom: 24px;
  background: var(--bg-input);
  border-radius: var(--radius);
  padding: 3px;
  border: 1px solid var(--border);
}

.mode-tab {
  flex: 1;
  padding: 8px 16px;
  font-size: 13px;
  font-weight: 500;
  color: var(--text-muted);
  background: transparent;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-family: var(--font-sans);
  transition: all var(--transition);
  text-align: center;
}

.mode-tab:hover { color: var(--text-secondary); }
.mode-tab.active {
  background: var(--bg-card-hover);
  color: var(--text-primary);
  box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}

/* ===== Parse Loading ===== */
.parse-area {
  position: relative;
}

.parse-area textarea {
  min-height: 260px;
  font-size: 14px;
  line-height: 1.7;
}

.parse-actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 12px;
}

.parse-hint {
  font-size: 12px;
  color: var(--text-muted);
}

.btn-parse {
  background: linear-gradient(135deg, #8b5cf6, #3b82f6);
  color: #fff;
  border: none;
  padding: 10px 24px;
  border-radius: var(--radius);
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  font-family: var(--font-sans);
  transition: all var(--transition);
  display: inline-flex;
  align-items: center;
  gap: 8px;
}
.btn-parse:hover { opacity: 0.9; transform: translateY(-1px); }
.btn-parse:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.btn-parse .parse-spinner {
  width: 16px;
  height: 16px;
  border: 2px solid rgba(255,255,255,0.3);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  display: none;
}
.btn-parse.loading .parse-spinner { display: inline-block; }
.btn-parse.loading .parse-label { display: none; }
.btn-parse .parse-loading-text { display: none; }
.btn-parse.loading .parse-loading-text { display: inline; }

/* ===== Responsive ===== */
@media (max-width: 768px) {
  .stats-grid { grid-template-columns: 1fr; }
  .main-content { padding: 16px; }
  .topbar { padding: 0 16px; }
  .modal { width: 95%; margin: 16px; }
  .login-box { width: 90%; padding: 32px 24px; }
  .search-params-row { grid-template-columns: 1fr; }
}

/* ===== Stale Badge (B1) ===== */
.stale-badge {
  display: inline-block;
  padding: 2px 8px;
  background: var(--yellow-bg);
  color: var(--yellow);
  font-size: 11px;
  font-weight: 600;
  border-radius: 4px;
  margin-left: 8px;
}

/* ===== Version History (B3) ===== */
.version-list { display: flex; flex-direction: column; gap: 8px; }
.version-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  background: var(--bg-input);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: border-color var(--transition);
}
.version-item:hover { border-color: var(--accent); }
.version-info { display: flex; flex-direction: column; gap: 2px; }
.version-info .ver-num { font-weight: 600; font-family: var(--font-mono); font-size: 14px; }
.version-info .ver-meta { font-size: 12px; color: var(--text-muted); }
.version-actions { display: flex; gap: 8px; align-items: center; }
.version-snapshot {
  margin-top: 8px;
  padding: 16px;
  background: var(--bg-primary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  font-size: 13px;
  color: var(--text-secondary);
}
.version-snapshot .snap-field { margin-bottom: 8px; }
.version-snapshot .snap-label { font-weight: 600; color: var(--text-muted); font-size: 12px; text-transform: uppercase; }

/* ===== Dedup Panel (B2) ===== */
.dup-pair {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  gap: 16px;
  padding: 20px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  margin-bottom: 16px;
  align-items: start;
}
.dup-card {
  padding: 16px;
  background: var(--bg-input);
  border: 1px solid var(--border);
  border-radius: var(--radius);
}
.dup-card h4 { font-size: 14px; margin-bottom: 8px; }
.dup-card p { font-size: 13px; color: var(--text-secondary); margin-bottom: 4px; }
.dup-vs {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 12px;
}
.dup-vs .sim-score {
  font-family: var(--font-mono);
  font-size: 16px;
  font-weight: 700;
  color: var(--yellow);
}

/* ===== Import/Export (B4) ===== */
.import-drop-zone {
  border: 2px dashed var(--border);
  border-radius: var(--radius-lg);
  padding: 40px 20px;
  text-align: center;
  color: var(--text-muted);
  cursor: pointer;
  transition: all var(--transition);
}
.import-drop-zone:hover, .import-drop-zone.drag-over {
  border-color: var(--accent);
  background: var(--accent-glow);
  color: var(--text-secondary);
}
.import-drop-zone input[type="file"] { display: none; }

.hidden { display: none !important; }
</style>
</head>
<body>

<!-- ===== Login Screen ===== -->
<div id="login-screen">
  <div class="login-box">
    <div class="logo">team_memory</div>
    <div class="subtitle">å›¢é˜Ÿç»éªŒæ•°æ®åº“ â€” è¯·è¾“å…¥ API Key ç™»å½•</div>
    <div id="login-error" class="error-msg"></div>
    <div class="form-group">
      <label for="login-key">API Key</label>
      <input type="password" id="login-key" placeholder="è¾“å…¥ä½ çš„ API Key..." autofocus>
    </div>
    <button class="btn btn-primary btn-full" onclick="doLogin()">ç™» å½•</button>
  </div>
</div>

<!-- ===== App Screen ===== -->
<div id="app-screen">
  <!-- Top Bar -->
  <div class="topbar">
    <div class="topbar-left">
      <div class="topbar-logo">team_memory</div>
      <nav class="topbar-nav">
        <a onclick="navigate('dashboard')" data-page="dashboard">ä»ªè¡¨ç›˜</a>
        <a onclick="navigate('list')" data-page="list">ç»éªŒåˆ—è¡¨</a>
        <a onclick="navigate('drafts')" data-page="drafts">è‰ç¨¿ç®±</a>
        <a onclick="navigate('reviews')" data-page="reviews">å®¡æ ¸é˜Ÿåˆ—</a>
        <a onclick="navigate('search')" data-page="search">è¯­ä¹‰æœç´¢</a>
        <a onclick="navigate('dedup')" data-page="dedup">å»é‡æ£€æµ‹</a>
        <a onclick="navigate('settings')" data-page="settings">è®¾ç½®</a>
      </nav>
    </div>
    <div class="topbar-right">
      <button class="btn btn-primary btn-sm" onclick="openCreateModal()">+ æ–°å»ºç»éªŒ</button>
      <div class="user-badge">
        <div class="user-avatar" id="user-avatar">A</div>
        <span id="user-name">admin</span>
      </div>
      <button class="logout-btn" onclick="doLogout()">é€€å‡º</button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Dashboard Page -->
    <div id="page-dashboard" class="page">
      <div class="stats-grid" style="grid-template-columns: repeat(6, 1fr)">
        <div class="stat-card">
          <div class="stat-value" id="stat-total">â€”</div>
          <div class="stat-label">æ€»ç»éªŒæ•°</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="stat-recent">â€”</div>
          <div class="stat-label">è¿‘ 7 å¤©æ–°å¢</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="stat-tags">â€”</div>
          <div class="stat-label">æ ‡ç­¾æ•°é‡</div>
        </div>
        <div class="stat-card" style="cursor:pointer" onclick="navigate('reviews')" title="ç‚¹å‡»æŸ¥çœ‹å¾…å®¡æ ¸ç»éªŒ">
          <div class="stat-value" id="stat-pending" style="color:var(--yellow)">â€”</div>
          <div class="stat-label">å¾…å®¡æ ¸</div>
        </div>
        <div class="stat-card" style="cursor:pointer" onclick="navigate('drafts')" title="ç‚¹å‡»æŸ¥çœ‹è‰ç¨¿ç®±">
          <div class="stat-value" id="stat-drafts" style="color:var(--accent)">â€”</div>
          <div class="stat-label">è‰ç¨¿</div>
        </div>
        <div class="stat-card" style="cursor:pointer" onclick="navigate('dedup')" title="ç‚¹å‡»æŸ¥çœ‹è¿‡æœŸç»éªŒ">
          <div class="stat-value" id="stat-stale" style="color:var(--yellow)">â€”</div>
          <div class="stat-label">ç–‘ä¼¼è¿‡æ—¶</div>
        </div>
      </div>
      <h3 style="font-size:16px;font-weight:600;margin-bottom:16px;color:var(--text-secondary)">æ ‡ç­¾åˆ†å¸ƒ</h3>
      <div id="dashboard-tags" class="tags-bar">
        <span class="tag-label">åŠ è½½ä¸­...</span>
      </div>
      <h3 style="font-size:16px;font-weight:600;margin:24px 0 16px;color:var(--text-secondary)">æœ€è¿‘æ·»åŠ </h3>
      <div id="dashboard-recent" class="exp-list">
        <div class="loading"><div class="spinner"></div></div>
      </div>
    </div>

    <!-- List Page -->
    <div id="page-list" class="page hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
        <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap">
          <h3 style="font-size:16px;font-weight:600;color:var(--text-secondary)">ç»éªŒåˆ—è¡¨</h3>
          <select id="list-status-filter" onchange="loadList(1)" style="background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border);border-radius:var(--radius);padding:4px 10px;font-size:13px;cursor:pointer">
            <option value="">å·²å‘å¸ƒ</option>
            <option value="all">å…¨éƒ¨çŠ¶æ€</option>
            <option value="draft">ä»…è‰ç¨¿</option>
          </select>
          <select id="list-type-filter" onchange="loadList(1)" style="background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border);border-radius:var(--radius);padding:4px 10px;font-size:13px;cursor:pointer">
            <option value="">å…¨éƒ¨ç±»å‹</option>
          </select>
          <select id="list-severity-filter" onchange="loadList(1)" style="background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border);border-radius:var(--radius);padding:4px 10px;font-size:13px;cursor:pointer">
            <option value="">å…¨éƒ¨ä¸¥é‡ç¨‹åº¦</option>
          </select>
          <select id="list-category-filter" onchange="loadList(1)" style="background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border);border-radius:var(--radius);padding:4px 10px;font-size:13px;cursor:pointer">
            <option value="">å…¨éƒ¨åˆ†ç±»</option>
            <option value="other">other</option>
          </select>
          <select id="list-progress-filter" onchange="loadList(1)" style="background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border);border-radius:var(--radius);padding:4px 10px;font-size:13px;cursor:pointer">
            <option value="">å…¨éƒ¨è¿›åº¦</option>
            <option value="open">open</option>
            <option value="investigating">investigating</option>
            <option value="fixed">fixed</option>
            <option value="verified">verified</option>
            <option value="planning">planning</option>
            <option value="developing">developing</option>
            <option value="testing">testing</option>
            <option value="released">released</option>
            <option value="researching">researching</option>
            <option value="reviewing">reviewing</option>
            <option value="implementing">implementing</option>
            <option value="completed">completed</option>
            <option value="detected">detected</option>
            <option value="mitigating">mitigating</option>
            <option value="resolved">resolved</option>
            <option value="post_mortem">post_mortem</option>
          </select>
          <input type="text" id="list-project-filter" onchange="loadList(1)" placeholder="é¡¹ç›®ï¼ˆé»˜è®¤ defaultï¼‰" style="background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border);border-radius:var(--radius);padding:4px 10px;font-size:13px;min-width:180px">
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn btn-secondary btn-sm" onclick="batchSummarize()">æ‰¹é‡ç”Ÿæˆæ‘˜è¦</button>
          <button class="btn btn-secondary btn-sm" onclick="openImportModal()">å¯¼å…¥</button>
          <button class="btn btn-secondary btn-sm" onclick="openExportModal()">å¯¼å‡º</button>
        </div>
      </div>
      <div id="list-tags-bar" class="tags-bar">
        <span class="tag-label">æ ‡ç­¾ç­›é€‰:</span>
      </div>
      <div id="list-content" class="exp-list">
        <div class="loading"><div class="spinner"></div></div>
      </div>
      <div id="list-pagination" class="pagination"></div>
    </div>

    <!-- Drafts Page (P0-1) -->
    <div id="page-drafts" class="page hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
        <h3 style="font-size:16px;font-weight:600;color:var(--text-secondary)">è‰ç¨¿ç®±</h3>
        <span style="font-size:13px;color:var(--text-muted)">è‰ç¨¿éœ€å‘å¸ƒåæ‰èƒ½è¢«æœç´¢åˆ°</span>
      </div>
      <div id="drafts-content" class="exp-list">
        <div class="loading"><div class="spinner"></div></div>
      </div>
    </div>

    <!-- Reviews Page (P0-2) -->
    <div id="page-reviews" class="page hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
        <h3 style="font-size:16px;font-weight:600;color:var(--text-secondary)">å®¡æ ¸é˜Ÿåˆ—</h3>
        <span style="font-size:13px;color:var(--text-muted)">AI å½•å…¥çš„ç»éªŒéœ€å®¡æ ¸åå‘å¸ƒ</span>
      </div>
      <div id="reviews-content" class="exp-list">
        <div class="loading"><div class="spinner"></div></div>
      </div>
    </div>

    <!-- Search Page -->
    <div id="page-search" class="page hidden">
      <div class="search-bar">
        <input type="text" id="search-input" placeholder="è¾“å…¥è‡ªç„¶è¯­è¨€æè¿°è¿›è¡Œè¯­ä¹‰æœç´¢..." onkeydown="if(event.key==='Enter')doSearch()">
        <button class="btn btn-primary" onclick="doSearch()">æœç´¢</button>
      </div>
      <div class="search-advanced-toggle" onclick="toggleSearchAdvanced()">
        <span>é«˜çº§å‚æ•°</span>
        <span class="toggle-arrow">â–¸</span>
      </div>
      <div id="search-advanced" class="search-advanced hidden">
        <div class="search-params-row">
          <div class="form-group" style="margin-bottom:0">
            <label>æœ€å¤§è¿”å›æ•°</label>
            <input type="number" id="search-max-results" placeholder="é»˜è®¤" min="1" step="1">
          </div>
          <div class="form-group" style="margin-bottom:0">
            <label>æ¯ç»„å­ç»éªŒæ•°</label>
            <input type="number" id="search-top-k-children" placeholder="é»˜è®¤" min="0" step="1">
          </div>
          <div class="form-group" style="margin-bottom:0">
            <label>æœ€ä½è¯„åˆ†</label>
            <input type="number" id="search-min-avg-rating" placeholder="é»˜è®¤" min="0" step="0.1">
          </div>
          <div class="form-group" style="margin-bottom:0">
            <label>PageIndex-Lite</label>
            <select id="search-use-pageindex">
              <option value="">é»˜è®¤</option>
              <option value="true">å¯ç”¨</option>
              <option value="false">ç¦ç”¨</option>
            </select>
          </div>
          <div class="form-group" style="margin-bottom:0">
            <label>é¡¹ç›®</label>
            <input type="text" id="search-project" placeholder="é»˜è®¤é¡¹ç›®">
          </div>
        </div>
      </div>
      <div id="search-results" class="exp-list">
        <div class="empty-state">
          <div class="icon">ğŸ”</div>
          <h3>è¾“å…¥å…³é”®è¯å¼€å§‹æœç´¢</h3>
          <p>åŸºäºå‘é‡è¯­ä¹‰åŒ¹é…ï¼Œå¯ä»¥ç”¨è‡ªç„¶è¯­è¨€æè¿°ä½ é‡åˆ°çš„é—®é¢˜</p>
        </div>
      </div>
    </div>

    <!-- Dedup Page (B2) -->
    <div id="page-dedup" class="page hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:24px">
        <div>
          <h3 style="font-size:18px;font-weight:600;color:var(--text-primary);margin-bottom:4px">å»é‡æ£€æµ‹ä¸åˆå¹¶</h3>
          <p style="font-size:13px;color:var(--text-muted)">æ£€æµ‹è¯­ä¹‰ç›¸ä¼¼åº¦è¶…è¿‡é˜ˆå€¼çš„ç»éªŒå¯¹ï¼Œé€‰æ‹©ä¿ç•™ä¸»ç»éªŒå¹¶åˆå¹¶</p>
        </div>
        <div style="display:flex;gap:12px;align-items:center">
          <label style="font-size:13px;color:var(--text-secondary)">ç›¸ä¼¼åº¦é˜ˆå€¼:</label>
          <input type="number" id="dedup-threshold" value="0.92" min="0.5" max="1" step="0.01" style="width:80px;padding:6px 10px;font-size:13px">
          <button class="btn btn-primary btn-sm" onclick="loadDuplicates()">æ‰«æ</button>
          <button class="btn btn-secondary btn-sm" onclick="scanStale()">æ‰«æè¿‡æœŸ</button>
        </div>
      </div>
      <div id="stale-results" class="hidden" style="margin-bottom:24px">
        <h4 style="font-size:14px;font-weight:600;color:var(--yellow);margin-bottom:12px">ç–‘ä¼¼è¿‡æ—¶çš„ç»éªŒ</h4>
        <div id="stale-list" class="exp-list"></div>
      </div>
      <div id="dedup-results">
        <div class="empty-state">
          <div class="icon">ğŸ”</div>
          <h3>ç‚¹å‡»"æ‰«æ"æ£€æµ‹é‡å¤ç»éªŒ</h3>
          <p>ç³»ç»Ÿå°†æ¯”è¾ƒæ‰€æœ‰ç»éªŒçš„å‘é‡åµŒå…¥ï¼Œæ‰¾å‡ºç›¸ä¼¼åº¦è¶…è¿‡é˜ˆå€¼çš„ç»éªŒå¯¹</p>
        </div>
      </div>
    </div>

    <!-- Settings Page -->
    <div id="page-settings" class="page hidden">
      <div class="settings-card">
        <h2>æ£€ç´¢å‚æ•°é…ç½®</h2>
        <p class="settings-desc">è°ƒæ•´ç»éªŒæ£€ç´¢å’Œä¸Šä¸‹æ–‡è£å‰ªå‚æ•°ã€‚ä¿®æ”¹åå³æ—¶ç”Ÿæ•ˆï¼ˆè¿è¡Œæ—¶ï¼‰ï¼Œé‡å¯æœåŠ¡åæ¢å¤ config.yaml ä¸­çš„é»˜è®¤å€¼ã€‚</p>
        <div class="settings-grid">
          <div class="form-group">
            <label>max_tokens <span class="hint">(è¿”å›å†…å®¹ token ä¸Šé™ï¼Œç©º=ä¸é™)</span></label>
            <input type="number" id="cfg-max-tokens" placeholder="ä¸é™åˆ¶" min="0" step="256">
          </div>
          <div class="form-group">
            <label>max_count <span class="hint">(æœ€å¤§è¿”å›ç»éªŒç»„æ•°)</span></label>
            <input type="number" id="cfg-max-count" placeholder="20" min="1" step="1">
          </div>
          <div class="form-group">
            <label>trim_strategy <span class="hint">(è£å‰ªç­–ç•¥)</span></label>
            <select id="cfg-trim-strategy">
              <option value="top_k">top_k â€” æŒ‰è¯„åˆ†å–å‰ K æ¡å­ç»éªŒ</option>
              <option value="summary">summary â€” è¶…å‡ºæ—¶ç”¨ LLM æ‘˜è¦</option>
            </select>
          </div>
          <div class="form-group">
            <label>top_k_children <span class="hint">(æ¯ç»„æœ€å¤šå­ç»éªŒæ•°)</span></label>
            <input type="number" id="cfg-top-k-children" placeholder="3" min="0" step="1">
          </div>
          <div class="form-group">
            <label>min_avg_rating <span class="hint">(æœ€ä½å¹³å‡è¯„åˆ†è¿‡æ»¤ï¼Œ0=å…³é—­)</span></label>
            <input type="number" id="cfg-min-avg-rating" placeholder="0.0" min="0" max="5" step="0.1">
          </div>
          <div class="form-group">
            <label>rating_weight <span class="hint">(è¯„åˆ†æƒé‡ 0~1)</span></label>
            <input type="number" id="cfg-rating-weight" placeholder="0.3" min="0" max="1" step="0.05">
          </div>
          <div class="form-group full-width">
            <label>summary_model <span class="hint">(summary ç­–ç•¥ä½¿ç”¨çš„ LLM æ¨¡å‹ï¼Œç©º=ä½¿ç”¨ llm.model)</span></label>
            <input type="text" id="cfg-summary-model" placeholder="ä½¿ç”¨é»˜è®¤ LLM æ¨¡å‹">
          </div>
        </div>
        <div class="settings-actions">
          <button class="btn btn-primary" onclick="saveRetrievalConfig()">ä¿å­˜æ£€ç´¢é…ç½®</button>
          <button class="btn btn-secondary" onclick="loadAllConfig()">é‡æ–°åŠ è½½å…¨éƒ¨</button>
          <span id="settings-save-status" class="save-status"></span>
        </div>
      </div>

      <div class="settings-card" style="margin-top:20px">
        <h2>é»˜è®¤é¡¹ç›®é…ç½®</h2>
        <p class="settings-desc">ç”¨äºå¤šé¡¹ç›®è½»é‡éš”ç¦»ã€‚æœªæ˜¾å¼ä¼  `project` æ—¶ï¼ŒWeb/API/MCP å°†å›é€€åˆ°è¯¥é»˜è®¤å€¼ã€‚</p>
        <div class="settings-grid">
          <div class="form-group full-width">
            <label>default_project</label>
            <input type="text" id="cfg-default-project" placeholder="default">
          </div>
        </div>
        <div class="settings-actions">
          <button class="btn btn-primary" onclick="saveDefaultProjectConfig()">ä¿å­˜é»˜è®¤é¡¹ç›®</button>
        </div>
      </div>

      <div class="settings-card" style="margin-top:20px">
        <h2>PageIndex-Lite é…ç½®</h2>
        <p class="settings-desc">é•¿æ–‡æ¡£ç« èŠ‚æ ‘æ£€ç´¢å¢å¼ºå±‚é…ç½®ï¼ˆä¸æ›¿ä»£åŸå‘é‡/FTSä¸»æµç¨‹ï¼‰ã€‚</p>
        <div class="settings-grid">
          <div class="form-group">
            <label>enabled <span class="hint">(æ˜¯å¦å¯ç”¨)</span></label>
            <select id="cfg-pg-enabled">
              <option value="true">å¯ç”¨</option>
              <option value="false">ç¦ç”¨</option>
            </select>
          </div>
          <div class="form-group">
            <label>only_long_docs <span class="hint">(ä»…é•¿æ–‡æ¡£æ„æ ‘)</span></label>
            <select id="cfg-pg-only-long">
              <option value="true">æ˜¯</option>
              <option value="false">å¦</option>
            </select>
          </div>
          <div class="form-group">
            <label>min_doc_chars <span class="hint">(é•¿æ–‡æ¡£é˜ˆå€¼)</span></label>
            <input type="number" id="cfg-pg-min-doc-chars" placeholder="800" min="1" step="1">
          </div>
          <div class="form-group">
            <label>max_tree_depth <span class="hint">(æœ€å¤§å±‚çº§)</span></label>
            <input type="number" id="cfg-pg-max-depth" placeholder="4" min="1" step="1">
          </div>
          <div class="form-group">
            <label>max_nodes_per_doc <span class="hint">(å•æ–‡æ¡£æœ€å¤§èŠ‚ç‚¹)</span></label>
            <input type="number" id="cfg-pg-max-nodes" placeholder="40" min="1" step="1">
          </div>
          <div class="form-group">
            <label>max_node_chars <span class="hint">(èŠ‚ç‚¹å†…å®¹æˆªæ–­é•¿åº¦)</span></label>
            <input type="number" id="cfg-pg-max-node-chars" placeholder="1200" min="100" step="50">
          </div>
          <div class="form-group">
            <label>tree_weight <span class="hint">(æ ‘æ£€ç´¢æƒé‡)</span></label>
            <input type="number" id="cfg-pg-weight" placeholder="0.15" min="0" max="1" step="0.01">
          </div>
          <div class="form-group">
            <label>min_node_score <span class="hint">(èŠ‚ç‚¹æœ€ä½å‘½ä¸­åˆ†)</span></label>
            <input type="number" id="cfg-pg-min-score" placeholder="0.01" min="0" max="1" step="0.01">
          </div>
          <div class="form-group">
            <label>include_matched_nodes <span class="hint">(è¿”å›å‘½ä¸­èŠ‚ç‚¹)</span></label>
            <select id="cfg-pg-include-nodes">
              <option value="true">æ˜¯</option>
              <option value="false">å¦</option>
            </select>
          </div>
        </div>
        <div class="settings-actions">
          <button class="btn btn-primary" onclick="savePageIndexLiteConfig()">ä¿å­˜ PageIndex-Lite é…ç½®</button>
        </div>
      </div>

      <div class="settings-card" style="margin-top:20px">
        <h2>å¯å®‰è£… Rules / Prompts</h2>
        <p class="settings-desc">æµè§ˆæœ¬åœ°ä¸å…±äº«æ³¨å†Œè¡¨ä¸­çš„å¯å®‰è£…é¡¹ï¼Œæ”¯æŒé¢„è§ˆå¹¶ä¸€é”®å®‰è£…åˆ°é¡¹ç›® `.cursor/` ç›®å½•ã€‚</p>
        <div class="settings-grid">
          <div class="form-group">
            <label>æ¥æº</label>
            <select id="installables-source-filter" onchange="loadInstallables()">
              <option value="">å…¨éƒ¨</option>
              <option value="local">local</option>
              <option value="registry">registry</option>
            </select>
          </div>
          <div class="form-group">
            <label>ç±»å‹</label>
            <select id="installables-type-filter" onchange="loadInstallables()">
              <option value="">å…¨éƒ¨</option>
              <option value="rule">rule</option>
              <option value="prompt">prompt</option>
            </select>
          </div>
        </div>
        <div class="settings-actions">
          <button class="btn btn-secondary" onclick="loadInstallables()">åˆ·æ–°åˆ—è¡¨</button>
        </div>
        <div id="installables-list" class="exp-list" style="margin-top:10px">
          <div class="empty-state"><h3>æš‚æ— æ•°æ®</h3><p>ç‚¹å‡»â€œåˆ·æ–°åˆ—è¡¨â€åŠ è½½å¯å®‰è£…é¡¹</p></div>
        </div>
        <div style="margin-top:12px">
          <label style="font-size:12px;color:var(--text-muted)">é¢„è§ˆå†…å®¹</label>
          <pre id="installables-preview" class="code-block" style="max-height:260px;overflow:auto;white-space:pre-wrap">é€‰æ‹©ä¸€é¡¹åç‚¹å‡»â€œé¢„è§ˆâ€</pre>
        </div>
      </div>

      <!-- Search Pipeline Config -->
      <div class="settings-card" style="margin-top:20px">
        <h2>æœç´¢ç®¡çº¿é…ç½®</h2>
        <p class="settings-desc">é…ç½®æ··åˆæ£€ç´¢æ¨¡å¼ã€RRF èåˆå‚æ•°å’Œè‡ªé€‚åº”è¿‡æ»¤ã€‚</p>
        <div class="settings-grid">
          <div class="form-group">
            <label>search mode <span class="hint">(æœç´¢æ¨¡å¼)</span></label>
            <select id="cfg-search-mode">
              <option value="hybrid">hybrid â€” å‘é‡ + å…¨æ–‡æ··åˆæ£€ç´¢</option>
              <option value="vector">vector â€” ä»…å‘é‡æœç´¢</option>
              <option value="fts">fts â€” ä»…å…¨æ–‡æœç´¢</option>
            </select>
          </div>
          <div class="form-group">
            <label>rrf_k <span class="hint">(RRF å¸¸æ•°ï¼Œé€šå¸¸ä¸éœ€ä¿®æ”¹)</span></label>
            <input type="number" id="cfg-rrf-k" placeholder="60" min="1" step="1">
          </div>
          <div class="form-group">
            <label>vector_weight <span class="hint">(å‘é‡æœç´¢æƒé‡)</span></label>
            <input type="number" id="cfg-vector-weight" placeholder="0.7" min="0" max="1" step="0.05">
          </div>
          <div class="form-group">
            <label>fts_weight <span class="hint">(å…¨æ–‡æœç´¢æƒé‡)</span></label>
            <input type="number" id="cfg-fts-weight" placeholder="0.3" min="0" max="1" step="0.05">
          </div>
          <div class="form-group">
            <label>adaptive_filter <span class="hint">(è‡ªé€‚åº”è¿‡æ»¤)</span></label>
            <select id="cfg-adaptive-filter">
              <option value="true">å¯ç”¨ â€” è‡ªåŠ¨è¿‡æ»¤ä½åˆ†ç»“æœ</option>
              <option value="false">ç¦ç”¨</option>
            </select>
          </div>
          <div class="form-group">
            <label>score_gap_threshold <span class="hint">(åˆ†æ•°é—´éš™é˜ˆå€¼)</span></label>
            <input type="number" id="cfg-score-gap" placeholder="0.15" min="0" max="1" step="0.05">
          </div>
          <div class="form-group">
            <label>min_confidence_ratio <span class="hint">(æœ€ä½ç½®ä¿¡åº¦æ¯”ç‡)</span></label>
            <input type="number" id="cfg-min-confidence" placeholder="0.6" min="0" max="1" step="0.05">
          </div>
        </div>
        <div class="settings-actions">
          <button class="btn btn-primary" onclick="saveSearchConfig()">ä¿å­˜æœç´¢é…ç½®</button>
        </div>
      </div>

      <!-- Reranker Config -->
      <div class="settings-card" style="margin-top:20px">
        <h2>Reranker ç²¾æ’é…ç½®</h2>
        <p class="settings-desc">é…ç½®æœåŠ¡ç«¯ç²¾æ’ã€‚provider=none æ—¶ä¸å¯ç”¨ç²¾æ’ï¼Œç”±å®¢æˆ·ç«¯ LLM é€šè¿‡ confidence å­—æ®µè‡ªè¡Œåˆ¤æ–­ã€‚æ›´æ”¹ provider éœ€é‡å¯æœåŠ¡ç”Ÿæ•ˆã€‚</p>
        <div class="settings-grid">
          <div class="form-group full-width">
            <label>provider <span class="hint">(ç²¾æ’æ¨¡å¼)</span></label>
            <select id="cfg-reranker-provider">
              <option value="none">none â€” ä¸å¯ç”¨æœåŠ¡ç«¯ç²¾æ’ï¼ˆå®¢æˆ·ç«¯è‡ªè¡Œåˆ¤æ–­ï¼‰</option>
              <option value="ollama_llm">ollama_llm â€” ä½¿ç”¨ Ollama LLM æ‰“åˆ†ç²¾æ’</option>
              <option value="cross_encoder">cross_encoder â€” ä½¿ç”¨æœ¬åœ° cross-encoder æ¨¡å‹</option>
              <option value="jina">jina â€” ä½¿ç”¨ Jina Reranker API</option>
            </select>
          </div>
        </div>
        <div class="settings-actions">
          <button class="btn btn-primary" onclick="saveRerankerConfig()">ä¿å­˜ Reranker é…ç½®</button>
          <span class="hint" style="margin-left:10px">æ›´æ”¹ provider åéœ€é‡å¯æœåŠ¡</span>
        </div>
      </div>

      <!-- Cache Config -->
      <div class="settings-card" style="margin-top:20px">
        <h2>ç¼“å­˜é…ç½®</h2>
        <p class="settings-desc">æŸ¥è¯¢ç»“æœå’Œå‘é‡åµŒå…¥çš„å†…å­˜ç¼“å­˜ï¼Œå‡å°‘é‡å¤è®¡ç®—ã€‚</p>
        <div class="settings-grid">
          <div class="form-group">
            <label>enabled <span class="hint">(å¯ç”¨ç¼“å­˜)</span></label>
            <select id="cfg-cache-enabled">
              <option value="true">å¯ç”¨</option>
              <option value="false">ç¦ç”¨</option>
            </select>
          </div>
          <div class="form-group">
            <label>ttl_seconds <span class="hint">(ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œç§’)</span></label>
            <input type="number" id="cfg-cache-ttl" placeholder="300" min="0" step="30">
          </div>
          <div class="form-group">
            <label>max_size <span class="hint">(æœ€å¤§ç¼“å­˜æœç´¢ç»“æœæ•°)</span></label>
            <input type="number" id="cfg-cache-max-size" placeholder="100" min="1" step="10">
          </div>
          <div class="form-group">
            <label>embedding_cache_size <span class="hint">(æœ€å¤§ç¼“å­˜å‘é‡æ•°)</span></label>
            <input type="number" id="cfg-cache-embedding-size" placeholder="200" min="1" step="10">
          </div>
        </div>
        <div class="settings-actions">
          <button class="btn btn-primary" onclick="saveCacheConfig()">ä¿å­˜ç¼“å­˜é…ç½®</button>
          <button class="btn btn-danger" onclick="clearCache()" style="margin-left:10px">æ¸…é™¤ç¼“å­˜</button>
        </div>
      </div>

      <div class="settings-card" style="margin-top:20px">
        <h2>Webhook é€šçŸ¥</h2>
        <p class="settings-desc">é…ç½®äº‹ä»¶é€šçŸ¥ç›®æ ‡ URLï¼Œå½“ç»éªŒåˆ›å»º/æ›´æ–°/å‘å¸ƒæ—¶è‡ªåŠ¨å‘é€ HTTP é€šçŸ¥ã€‚</p>
        <div id="webhook-list" style="margin-bottom:12px"></div>
        <div class="settings-actions">
          <button class="btn btn-primary" onclick="addWebhookRow()">æ·»åŠ  Webhook</button>
          <button class="btn btn-primary" onclick="saveWebhookConfig()" style="margin-left:10px">ä¿å­˜é…ç½®</button>
        </div>
      </div>

      <div class="settings-card" style="margin-top:20px">
        <h2>Schema é…ç½®</h2>
        <p class="settings-desc">å½“å‰ç”Ÿæ•ˆçš„ç»éªŒç±»å‹ä½“ç³»ã€‚å¯åˆ‡æ¢é¢„è®¾åŒ…æˆ–ä»ç¤ºä¾‹æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆã€‚</p>
        <div style="margin-bottom:12px">
          <label>é¢„è®¾åŒ…:</label>
          <select id="schema-preset-select" style="background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border);border-radius:var(--radius);padding:4px 10px;font-size:13px;margin-left:8px">
            <option value="software-dev">software-dev (è½¯ä»¶å¼€å‘)</option>
            <option value="data-engineering">data-engineering (æ•°æ®å·¥ç¨‹)</option>
            <option value="devops">devops (è¿ç»´)</option>
            <option value="general">general (é€šç”¨æç®€)</option>
          </select>
          <button class="btn btn-primary" onclick="switchPreset()" style="margin-left:8px">åˆ‡æ¢</button>
        </div>
        <div style="margin-bottom:12px">
          <label>ä»ç¤ºä¾‹æ–‡æ¡£ç”Ÿæˆ:</label>
          <textarea id="schema-gen-input" rows="4" placeholder="ç²˜è´´ä½ çš„æ–‡æ¡£æ¨¡æ¿æˆ–ç¤ºä¾‹æ–‡æ¡£..." style="width:100%;background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border);border-radius:var(--radius);padding:8px;font-size:13px;margin-top:6px"></textarea>
          <button class="btn btn-primary" onclick="generateSchemaFromDoc()" style="margin-top:6px">AI åˆ†æå¹¶ç”Ÿæˆ</button>
        </div>
        <div id="schema-preview" style="display:none;margin-top:12px">
          <h3 style="margin-bottom:8px">ç”Ÿæˆç»“æœé¢„è§ˆ:</h3>
          <pre id="schema-yaml-preview" style="background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border);border-radius:var(--radius);padding:12px;font-size:12px;overflow:auto;max-height:300px"></pre>
          <button class="btn btn-primary" onclick="applyGeneratedSchema()" style="margin-top:8px">åº”ç”¨æ­¤é…ç½®</button>
        </div>
        <div id="schema-current-types" style="margin-top:12px"></div>
      </div>
    </div>

    <!-- Detail Page -->
    <div id="page-detail" class="page hidden"></div>
  </div>
</div>

<!-- ===== Create/Edit Modal ===== -->
<div id="create-modal" class="modal-overlay hidden" onclick="if(event.target===this)closeCreateModal()">
  <div class="modal">
    <div class="modal-header">
      <h2>æ–°å»ºç»éªŒ</h2>
      <button class="modal-close" onclick="closeCreateModal()">&times;</button>
    </div>
    <div class="modal-body">
      <!-- Mode Tabs -->
      <div class="mode-tabs">
        <button class="mode-tab active" onclick="switchCreateMode('manual')" id="tab-manual">æ‰‹åŠ¨å¡«å†™</button>
        <button class="mode-tab" onclick="switchCreateMode('group')" id="tab-group">åˆ›å»ºç»éªŒç»„</button>
        <button class="mode-tab" onclick="switchCreateMode('document')" id="tab-document">ä»æ–‡æ¡£æå–</button>
        <button class="mode-tab" onclick="switchCreateMode('url')" id="tab-url">ä»é“¾æ¥å¯¼å…¥</button>
      </div>

      <!-- Document Parse Mode -->
      <div id="create-mode-document" class="hidden">
        <div class="parse-area">
          <div class="form-group">
            <label>ç²˜è´´æ–‡æ¡£å†…å®¹ï¼ˆæ”¯æŒ Markdown / çº¯æ–‡æœ¬ï¼‰</label>
            <textarea id="parse-content" placeholder="å°†ä½ çš„æ–‡æ¡£å†…å®¹ç²˜è´´åˆ°è¿™é‡Œ...&#10;&#10;æ”¯æŒ Markdown æ ¼å¼ï¼Œä¾‹å¦‚ï¼š&#10;&#10;# é—®é¢˜&#10;åœ¨ä½¿ç”¨ Docker éƒ¨ç½² FastAPI æ—¶é‡åˆ°äº†ç«¯å£å†²çª...&#10;&#10;# è§£å†³æ–¹æ¡ˆ&#10;é€šè¿‡ä¿®æ”¹ docker-compose.yml ä¸­çš„ç«¯å£æ˜ å°„...&#10;&#10;```python&#10;# ç›¸å…³ä»£ç &#10;```"></textarea>
          </div>
          <div class="parse-actions">
            <span class="parse-hint">AI å°†è‡ªåŠ¨æå–æ ‡é¢˜ã€é—®é¢˜ã€æ–¹æ¡ˆå’Œæ ‡ç­¾</span>
            <button class="btn-parse" id="btn-parse" onclick="doParse()">
              <span class="parse-spinner"></span>
              <span class="parse-label">AI æ™ºèƒ½æå–</span>
              <span class="parse-loading-text">æ­£åœ¨åˆ†ææ–‡æ¡£...</span>
            </button>
          </div>
        </div>
      </div>

      <!-- URL Import Mode -->
      <div id="create-mode-url" class="hidden">
        <div class="parse-area">
          <div class="form-group">
            <label>è¾“å…¥æ–‡æ¡£é“¾æ¥</label>
            <input type="url" id="parse-url" placeholder="https://example.com/blog/how-to-fix-xxx" style="font-family:var(--font-mono);font-size:13px">
          </div>
          <div class="parse-hint" style="margin-bottom:16px">æ”¯æŒç½‘é¡µã€Markdown æ–‡ä»¶ã€çº¯æ–‡æœ¬ç­‰é“¾æ¥ï¼ŒAI å°†è‡ªåŠ¨æŠ“å–å†…å®¹å¹¶æå–ç»éªŒä¿¡æ¯</div>
          <div class="parse-actions">
            <span class="parse-hint" id="url-status"></span>
            <button class="btn-parse" id="btn-parse-url" onclick="doParseURL()">
              <span class="parse-spinner"></span>
              <span class="parse-label">æŠ“å–å¹¶è§£æ</span>
              <span class="parse-loading-text">æ­£åœ¨æŠ“å–é¡µé¢...</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Group Mode (parent + children) -->
      <div id="create-mode-group" class="hidden">
        <div class="form-group">
          <label>çˆ¶ç»éªŒæ ‡é¢˜ *</label>
          <input type="text" id="group-parent-title" placeholder="ç»éªŒç»„çš„ä¸»æ ‡é¢˜...">
        </div>
        <div class="form-group">
          <label>çˆ¶ç»éªŒé—®é¢˜æè¿° *</label>
          <textarea id="group-parent-problem" placeholder="æ•´ä½“é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></textarea>
        </div>
        <div class="form-group">
          <label>çˆ¶ç»éªŒè§£å†³æ–¹æ¡ˆ *</label>
          <textarea id="group-parent-solution" placeholder="æ•´ä½“æ€è·¯æˆ–æ‘˜è¦..." style="min-height:80px"></textarea>
        </div>
        <div class="form-group">
          <label>çˆ¶ç»éªŒæ ‡ç­¾ï¼ˆé€—å·åˆ†éš”ï¼‰</label>
          <input type="text" id="group-parent-tags" placeholder="python, docker, fastapi">
        </div>
        <div class="form-group">
          <label>é¡¹ç›®</label>
          <input type="text" id="group-parent-project" placeholder="é»˜è®¤é¡¹ç›®">
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div class="form-group">
            <label>ç¼–ç¨‹è¯­è¨€</label>
            <input type="text" id="group-parent-language" placeholder="python">
          </div>
          <div class="form-group">
            <label>æ¡†æ¶</label>
            <input type="text" id="group-parent-framework" placeholder="fastapi">
          </div>
        </div>
        <div class="form-group">
          <label>çˆ¶ç»éªŒä»£ç ç‰‡æ®µ</label>
          <textarea id="group-parent-code" placeholder="ç›¸å…³ä»£ç ç¤ºä¾‹..." style="font-family:var(--font-mono);font-size:13px"></textarea>
        </div>
        <div class="form-group">
          <label>å­ç»éªŒ</label>
          <div id="group-children-container"></div>
          <button type="button" class="btn btn-secondary btn-sm" onclick="addGroupChild()" style="margin-top:8px">+ æ·»åŠ å­ç»éªŒ</button>
        </div>
      </div>

      <!-- Manual Mode (form fields) -->
      <div id="create-mode-manual">
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px">
          <label style="font-size:13px;color:var(--text-muted);cursor:pointer;display:flex;align-items:center;gap:6px">
            <input type="checkbox" id="create-quick-mode" onchange="toggleCreateQuickMode()" style="accent-color:var(--accent)">
            å¿«æ·æ¨¡å¼ï¼ˆä»…æ ‡é¢˜+é—®é¢˜+æ ‡ç­¾ï¼‰
          </label>
        </div>
        <div class="form-group">
          <label>ç±»å‹</label>
          <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
            <select id="create-experience-type" onchange="onCreateTypeChange()" style="background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border);flex:1;min-width:160px">
              <option value="general">ğŸ“ é€šç”¨ç»éªŒ</option>
            </select>
            <div id="ai-type-suggest" class="hidden" style="display:none;align-items:center;gap:6px;padding:4px 10px;border-radius:8px;background:var(--bg-hover);font-size:12px;color:var(--text-secondary);animation:fadeIn 0.3s ease">
              <span style="font-size:14px">ğŸ’¡</span>
              <span id="ai-type-suggest-text"></span>
              <button onclick="acceptTypeSuggestion()" style="background:var(--accent);color:white;border:none;border-radius:4px;padding:2px 8px;font-size:11px;cursor:pointer">é‡‡çº³</button>
              <button onclick="dismissTypeSuggestion()" style="background:none;border:none;color:var(--text-muted);cursor:pointer;font-size:13px;padding:2px">&times;</button>
            </div>
          </div>
        </div>
        <div class="form-group">
          <label>æ ‡é¢˜ *</label>
          <input type="text" id="create-title" placeholder="ç®€æ´æè¿°è¿™ä¸ªç»éªŒ..." oninput="onCreateInputForTypeSuggest()">
        </div>
        <div class="form-group">
          <label>é—®é¢˜æè¿° *</label>
          <textarea id="create-problem" placeholder="é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸Šä¸‹æ–‡æ˜¯ä»€ä¹ˆï¼Ÿ" oninput="onCreateInputForTypeSuggest()"></textarea>
        </div>
        <div class="form-group">
          <label>æ ‡ç­¾ï¼ˆé€—å·åˆ†éš”ï¼‰</label>
          <input type="text" id="create-tags" placeholder="python, docker, fastapi">
        </div>
        <div class="form-group">
          <label>é¡¹ç›®</label>
          <input type="text" id="create-project" placeholder="é»˜è®¤é¡¹ç›®">
        </div>
        <div id="create-type-specific-fields"></div>
        <div id="create-extended-fields">
          <div class="form-group">
            <label>è§£å†³æ–¹æ¡ˆ</label>
            <textarea id="create-solution" placeholder="å¦‚ä½•è§£å†³çš„ï¼Ÿå…³é”®æ­¥éª¤æ˜¯ä»€ä¹ˆï¼Ÿ" style="min-height:120px"></textarea>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
            <div class="form-group">
              <label>ç¼–ç¨‹è¯­è¨€</label>
              <input type="text" id="create-language" placeholder="python">
            </div>
            <div class="form-group">
              <label>æ¡†æ¶</label>
              <input type="text" id="create-framework" placeholder="fastapi">
            </div>
          </div>
          <div class="form-group">
            <label>ä»£ç ç‰‡æ®µ</label>
            <textarea id="create-code" placeholder="ç›¸å…³ä»£ç ç¤ºä¾‹..." style="font-family:var(--font-mono);font-size:13px"></textarea>
          </div>
          <div class="form-group">
            <label>Git å¼•ç”¨ï¼ˆæ¯è¡Œä¸€ä¸ªï¼Œæ ¼å¼: type|url|hash|æè¿°ï¼‰</label>
            <textarea id="create-git-refs" placeholder="pr|https://github.com/...|abc123|ä¿®å¤è¯´æ˜&#10;commit|https://...|def456|æäº¤è¯´æ˜" style="min-height:60px;font-family:var(--font-mono);font-size:12px"></textarea>
          </div>
          <div class="form-group">
            <label>ç›¸å…³é“¾æ¥ï¼ˆæ¯è¡Œä¸€ä¸ªï¼Œæ ¼å¼: url æˆ– url|æ ‡é¢˜ï¼‰</label>
            <textarea id="create-related-links" placeholder="https://example.com/doc&#10;https://wiki...|ç›¸å…³æ–‡æ¡£æ ‡é¢˜" style="min-height:60px;font-family:var(--font-mono);font-size:12px"></textarea>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer" style="display:flex;align-items:center;gap:16px">
      <label style="display:flex;align-items:center;gap:6px;font-size:13px;color:var(--text-secondary);cursor:pointer;margin-right:auto">
        <input type="checkbox" id="create-draft-checkbox" style="accent-color:var(--accent)">
        ä¿å­˜ä¸ºè‰ç¨¿
      </label>
      <button class="btn btn-secondary" onclick="closeCreateModal()">å–æ¶ˆ</button>
      <button class="btn btn-primary" id="btn-save-exp" onclick="doCreate()">ä¿å­˜ç»éªŒ</button>
    </div>
  </div>
</div>

<!-- ===== Edit Modal ===== -->
<div id="edit-modal" class="modal-overlay hidden" onclick="if(event.target===this)closeEditModal()">
  <div class="modal" style="max-width:720px">
    <div class="modal-header">
      <h2>ç¼–è¾‘ç»éªŒ</h2>
      <button class="modal-close" onclick="closeEditModal()">&times;</button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="edit-exp-id" value="">
      <div class="form-group">
        <label>ç±»å‹</label>
        <select id="edit-experience-type" onchange="onEditTypeChange()" style="background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border)">
          <option value="general">ğŸ“ é€šç”¨ç»éªŒ</option>
        </select>
      </div>
      <div class="form-group">
        <label>æ ‡é¢˜ *</label>
        <input type="text" id="edit-title" placeholder="ç®€æ´æè¿°è¿™ä¸ªç»éªŒ...">
      </div>
      <div class="form-group">
        <label>é—®é¢˜æè¿° *</label>
        <textarea id="edit-problem" placeholder="é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸Šä¸‹æ–‡æ˜¯ä»€ä¹ˆï¼Ÿ"></textarea>
      </div>
      <div class="form-group">
        <label>æ ¹å› åˆ†æ</label>
        <textarea id="edit-root-cause" placeholder="ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Ÿï¼ˆå¯é€‰ï¼‰"></textarea>
      </div>
      <div id="edit-type-specific-fields"></div>
      <div class="form-group">
        <label>è§£å†³æ–¹æ¡ˆ</label>
        <textarea id="edit-solution" placeholder="å¦‚ä½•è§£å†³çš„ï¼Ÿå…³é”®æ­¥éª¤æ˜¯ä»€ä¹ˆï¼Ÿ" style="min-height:120px"></textarea>
      </div>
      <div class="form-group">
        <label>æ ‡ç­¾ï¼ˆé€—å·åˆ†éš”ï¼‰</label>
        <input type="text" id="edit-tags" placeholder="python, docker, fastapi">
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
        <div class="form-group">
          <label>ç¼–ç¨‹è¯­è¨€</label>
          <input type="text" id="edit-language" placeholder="python">
        </div>
        <div class="form-group">
          <label>æ¡†æ¶</label>
          <input type="text" id="edit-framework" placeholder="fastapi">
        </div>
      </div>
      <div class="form-group">
        <label>ä»£ç ç‰‡æ®µ</label>
        <textarea id="edit-code" placeholder="ç›¸å…³ä»£ç ç¤ºä¾‹..." style="font-family:var(--font-mono);font-size:13px"></textarea>
      </div>
      <div class="form-group">
        <label>Git å¼•ç”¨ï¼ˆæ¯è¡Œä¸€ä¸ªï¼Œæ ¼å¼: type|url|hash|æè¿°ï¼‰</label>
        <textarea id="edit-git-refs" placeholder="pr|https://..." style="min-height:50px;font-family:var(--font-mono);font-size:12px"></textarea>
      </div>
      <div class="form-group">
        <label>ç›¸å…³é“¾æ¥ï¼ˆæ¯è¡Œä¸€ä¸ªï¼Œæ ¼å¼: url æˆ– url|æ ‡é¢˜ï¼‰</label>
        <textarea id="edit-related-links" placeholder="https://..." style="min-height:50px;font-family:var(--font-mono);font-size:12px"></textarea>
      </div>
      <div id="edit-children-section" class="form-group hidden">
        <label>å­ç»éªŒ</label>
        <div id="edit-children-container"></div>
        <button type="button" class="btn btn-secondary btn-sm" onclick="addEditChild()" style="margin-top:8px">+ æ·»åŠ å­ç»éªŒ</button>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeEditModal()">å–æ¶ˆ</button>
      <button class="btn btn-primary" onclick="submitEdit()">ç¡®è®¤ä¿®æ”¹</button>
    </div>
  </div>
</div>

<!-- ===== Feedback Modal ===== -->
<div id="feedback-modal" class="modal-overlay hidden" onclick="if(event.target===this)closeFeedbackModal()">
  <div class="modal" style="width:440px">
    <div class="modal-header">
      <h2>æäº¤åé¦ˆ</h2>
      <button class="modal-close" onclick="closeFeedbackModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label>è¯„åˆ†ï¼ˆ1-5 æ˜Ÿï¼‰</label>
        <div class="star-rating" id="star-rating" style="margin-top:8px">
          <input type="radio" id="star5" name="rating" value="5"><label for="star5" title="5 - éå¸¸æœ‰å¸®åŠ©">â˜…</label>
          <input type="radio" id="star4" name="rating" value="4"><label for="star4" title="4 - æœ‰å¸®åŠ©">â˜…</label>
          <input type="radio" id="star3" name="rating" value="3"><label for="star3" title="3 - ä¸€èˆ¬">â˜…</label>
          <input type="radio" id="star2" name="rating" value="2"><label for="star2" title="2 - ä¸å¤ªæœ‰å¸®åŠ©">â˜…</label>
          <input type="radio" id="star1" name="rating" value="1"><label for="star1" title="1 - æ²¡å¸®åŠ©">â˜…</label>
        </div>
      </div>
      <div class="form-group">
        <label>è¡¥å……è¯´æ˜ï¼ˆå¯é€‰ï¼‰</label>
        <textarea id="fb-comment" placeholder="ä»»ä½•è¡¥å……ä¿¡æ¯..." style="min-height:60px"></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeFeedbackModal()">å–æ¶ˆ</button>
      <button class="btn btn-primary" onclick="submitFeedback()">æäº¤åé¦ˆ</button>
    </div>
  </div>
</div>

<!-- ===== Import Modal (B4) ===== -->
<div id="import-modal" class="modal-overlay hidden" onclick="if(event.target===this)closeImportModal()">
  <div class="modal" style="width:520px">
    <div class="modal-header">
      <h2>å¯¼å…¥ç»éªŒ</h2>
      <button class="modal-close" onclick="closeImportModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="import-drop-zone" id="import-drop-zone" onclick="document.getElementById('import-file').click()">
        <input type="file" id="import-file" accept=".json,.csv" onchange="handleImportFile(this)">
        <div style="font-size:36px;margin-bottom:12px;opacity:0.4">ğŸ“</div>
        <div style="font-size:14px">ç‚¹å‡»é€‰æ‹©æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„</div>
        <div style="font-size:12px;margin-top:8px;color:var(--text-muted)">æ”¯æŒ .json å’Œ .csv æ ¼å¼</div>
      </div>
      <div id="import-preview" class="hidden" style="margin-top:16px">
        <div style="font-size:13px;color:var(--text-secondary);margin-bottom:8px" id="import-file-info"></div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeImportModal()">å–æ¶ˆ</button>
      <button class="btn btn-primary" id="btn-import" onclick="doImport()" disabled>å¼€å§‹å¯¼å…¥</button>
    </div>
  </div>
</div>

<!-- ===== Export Modal (B4) ===== -->
<div id="export-modal" class="modal-overlay hidden" onclick="if(event.target===this)closeExportModal()">
  <div class="modal" style="width:480px">
    <div class="modal-header">
      <h2>å¯¼å‡ºç»éªŒ</h2>
      <button class="modal-close" onclick="closeExportModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label>å¯¼å‡ºæ ¼å¼</label>
        <select id="export-format">
          <option value="json">JSONï¼ˆå®Œæ•´æ•°æ®ï¼Œå«çˆ¶å­å…³ç³»ï¼‰</option>
          <option value="csv">CSVï¼ˆæ‰å¹³æ•°æ®ï¼Œä¸å«çˆ¶å­å…³ç³»ï¼‰</option>
        </select>
      </div>
      <div class="form-group">
        <label>æŒ‰æ ‡ç­¾ç­›é€‰ï¼ˆå¯é€‰ï¼‰</label>
        <input type="text" id="export-tag" placeholder="ç•™ç©ºå¯¼å‡ºå…¨éƒ¨">
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
        <div class="form-group">
          <label>å¼€å§‹æ—¥æœŸï¼ˆå¯é€‰ï¼‰</label>
          <input type="date" id="export-start">
        </div>
        <div class="form-group">
          <label>ç»“æŸæ—¥æœŸï¼ˆå¯é€‰ï¼‰</label>
          <input type="date" id="export-end">
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeExportModal()">å–æ¶ˆ</button>
      <button class="btn btn-primary" onclick="doExport()">ä¸‹è½½å¯¼å‡ºæ–‡ä»¶</button>
    </div>
  </div>
</div>

<!-- Toast Container -->
<div class="toast-container" id="toast-container"></div>

<script type="module" src="/static/js/app.js"></script>
</body>
</html>
